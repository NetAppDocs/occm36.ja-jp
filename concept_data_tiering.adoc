---
sidebar: sidebar 
permalink: concept_data_tiering.html 
keywords: storage tiering, tier, tiering, data tiering, s3, s3 tiering, capacity, performance, s3 endpoint, fabric pool, fabricpool, s3 bucket, requirement, vpc endpoint, policy, policies, tiering policies, auto, snapshot only, backup, none, cooling period, volume tiering policies, blob, standard, infrequent access, hot, cool, tiering level, storage tier, storage class 
summary: コールドデータを低コストのオブジェクトストレージに自動階層化することで、ストレージコストを削減できます。 
---
= データ階層化の概要
:hardbreaks:
:allow-uri-read: 
:nofooter: 
:icons: font
:linkattrs: 
:imagesdir: ./media/


[role="lead"]
使用頻度の低いデータを低コストのオブジェクトストレージに自動的に階層化できるため、ストレージコストを削減できます。アクティブなデータはハイパフォーマンスの SSD または HDD （パフォーマンス階層）に残り、非アクティブなデータは低コストのオブジェクトストレージ（容量階層）に階層化されます。これにより、プライマリストレージのスペースを再利用し、セカンダリストレージを縮小できます。

Cloud Volumes ONTAP では、 AWS と Microsoft Azure のデータ階層化がサポートされます。データ階層化は、 FabricPool テクノロジによって実現されます。


NOTE: データ階層化を有効にするために機能ライセンスをインストールする必要はありません。



== AWS でのデータ階層化の仕組み

AWS でデータ階層化を有効にすると、 Cloud Volumes ONTAP はホットデータのパフォーマンス階層として EBS 、アクセス頻度の低いデータの大容量階層として AWS S3 を使用します。

image:diagram_storage_tiering.png["この概念図は、 EBS ストレージに移動中のホットデータと S3 ストレージに移動中の非アクティブデータを示しています。"]



=== AWS のパフォーマンス階層

パフォーマンス階層には、汎用 SSD 、プロビジョニングされた IOPS SSD 、スループットに最適化された HDD があります。



=== AWS の容量階層

Cloud Volumes ONTAP は、デフォルトではアクセス頻度の低いデータを S3_Standard_storage クラスに階層化します。Standard は、複数の可用性ゾーンにまたがって保存された頻繁にアクセスされるデータに最適です。

アクセス頻度の低いデータにアクセスしない場合は、 Cloud Volumes ONTAP の導入後にシステムの階層化レベルを次のいずれかに変更することで、ストレージコストを削減できます。

インテリジェントな階層化:: データアクセスパターンの変化に応じて 2 つの階層間でデータを移動することで、ストレージコストを最適化します。一方の階層は頻繁にアクセスするため、もう一方の階層はアクセス頻度の低いためです。
1 回のアクセスではほとんど発生しません:: アクセス頻度の低いデータを 1 つの可用性ゾーンに格納
標準的なアクセス頻度は低い:: アクセス頻度の低いデータを複数の可用性ゾーンに格納


データにアクセスする場合はアクセスコストが高くなるため、階層化レベルを変更する前に、アクセスコストを考慮する必要があります。S3 ストレージクラスの詳細については、を参照してください https://["AWS のドキュメント"^]。

階層化レベルを変更すると、アクセス頻度の低いデータは Standard ストレージクラスから始まり、 30 日経ってもアクセスされない場合は選択したストレージクラスに移動します。階層化レベルの変更の詳細については、を参照してください link:task_tiering.html["使用頻度の低いデータを低コストのオブジェクトストレージに階層化"]。

階層化レベルはシステム全体に適用され、ボリューム単位には適用されません。


NOTE: Cloud Volumes ONTAP の作業環境では、 S3 バケットを使用して、システムからのすべての階層データを取得します。ボリュームごとに異なる S3 バケットは使用されません。これには、 HA の作業環境が含まれます。Cloud Manager は S3 バケットを作成し、「 fabric-pool-_cluster unique identifier_ 」という名前を付けます。



== Microsoft Azure でのデータ階層化の仕組み

Azure でデータ階層化を有効にすると、 Cloud Volumes ONTAP は、ホットデータ用のパフォーマンス階層として Azure で管理されているディスクを、アクセス頻度の低いデータ用の大容量階層として Azure Blob Storage を使用します。

image:diagram_storage_tiering_azure.png["この概念図は、 Azure で管理されているディスクおよび Azure BLOB ストレージにアクセスするアクセス頻度の低いデータを示しています。"]



=== Azure のパフォーマンスティア

パフォーマンス階層は、プレミアムストレージ（ SSD ）または標準ストレージ（ HDD ）のいずれかです。



=== Azure のキャパシティティア

Cloud Volumes ONTAP は、アクセス頻度の高いデータに最適な、デフォルトではアクセス頻度の低いデータを azure_hot_storage 階層に階層化します。

アクセス頻度の低いデータにアクセスしない場合は、 Cloud Volumes ONTAP の導入後にシステムの階層化レベルを azure_cop_storage 階層に変更することで、ストレージコストを削減できます。Cool Tier は、アクセス頻度の低いデータが 30 日以上存在する場合に最適です。

データにアクセスする場合はアクセスコストが高くなるため、階層化レベルを変更する前に、アクセスコストを考慮する必要があります。Azure BLOB ストレージ層の詳細については、を参照してください https://["Azure に関するドキュメント"^]。

階層化レベルを変更すると、アクセス頻度の低いデータは最初はホットストレージ階層に配置され、アクセス日数が 30 日を超えない場合はアクセス頻度の低いストレージ階層に移動されます。階層化レベルの変更の詳細については、を参照してください link:task_tiering.html["使用頻度の低いデータを低コストのオブジェクトストレージに階層化"]。

階層化レベルはシステム全体に適用され、ボリューム単位には適用されません。


NOTE: Cloud Volumes ONTAP の作業環境では、システムのすべての階層データに Azure BLOB コンテナを使用します。ボリュームごとに異なるコンテナは使用されません。Cloud Manager は、 Cloud Volumes ONTAP システムごとにコンテナを持つ新しいストレージアカウントを作成します。ストレージアカウントの名前はランダムです。



== データ階層化が容量制限に与える影響

データの階層化を有効にしても、システムの容量制限は変わりません。この制限は、パフォーマンス階層と容量階層に分散されます。



== ボリューム階層化ポリシー

データ階層化を有効にするには、ボリュームの作成、変更、またはレプリケート時にボリューム階層化ポリシーを選択する必要があります。ボリュームごとに異なるポリシーを選択できます。

一部の階層化ポリシーには、最小冷却期間が関連付けられています。この期間は、データを「コールド」と見なして容量階層に移動するために、ボリューム内のユーザーデータを非アクティブのままにする必要がある時間を設定します。

Cloud Volumes ONTAP では、次の階層化ポリシーがサポートされています。

Snapshot のみ:: アグリゲートの容量が 50% に達すると、 Cloud Volumes ONTAP は、アクティブなファイルシステムに関連付けられていない Snapshot コピーのコールドユーザデータを容量階層に階層化します。冷却期間は約 2 日間です。
+
--
読み取りの場合、容量階層のコールドデータブロックはホットになり、パフォーマンス階層に移動されます。

--
自動:: アグリゲートの容量が 50% に達すると、 Cloud Volumes ONTAP はボリューム内のコールドデータブロックを容量階層に階層化します。コールドデータには、 Snapshot コピーだけでなく、アクティブなファイルシステムのコールドユーザデータも含まれます。冷却期間は約 31 日です。
+
--
このポリシーは、 Cloud Volumes ONTAP 9.4 以降でサポートされます。

ランダム読み取りで読み取りを行うと、容量階層のコールドデータブロックがホットになり、パフォーマンス階層に移動します。インデックススキャンやアンチウイルススキャンに関連するようなシーケンシャルリードで読み取られた場合、コールドデータブロックはコールド状態を維持し、パフォーマンス階層には移動しません。

--
バックアップ:: ディザスタリカバリまたは長期保存のためにボリュームをレプリケートする場合、デスティネーションボリュームのデータは容量階層で始まります。デスティネーションボリュームをアクティブにすると、データは読み取られた時点でパフォーマンス階層に徐々に移動します。
なし:: ボリュームのデータをパフォーマンス階層に保持し、容量階層に移動できないようにします。




== データ階層化の設定

手順およびサポートされている構成の一覧については、を参照してください link:task_tiering.html["使用頻度の低いデータを低コストのオブジェクトストレージに階層化"]。
